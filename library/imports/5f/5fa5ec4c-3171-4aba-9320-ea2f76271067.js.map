{"version":3,"sources":["assets\\script\\GameLayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DataManager from './DataManager';\r\nimport ItemNode from './ItemNode';\r\nimport { JsbFunType } from './util/define';\r\nimport util from './util/util';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameLayer extends cc.Component {\r\n    @property({ type: cc.Node, tooltip: '左侧layer' })\r\n    LLayer: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '右侧layer' })\r\n    RLayer: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '用户余额节点' })\r\n    userCoinNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏结果节点' })\r\n    resultNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏提示节点' })\r\n    tipNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '倒计时节点' })\r\n    timerNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Prefab, tooltip: '元素预制体' })\r\n    itemPrefab: cc.Prefab = null;\r\n\r\n    @property({ type: [cc.AudioClip], tooltip: '音效' })\r\n    audios: cc.AudioClip[] = [];\r\n\r\n    /** 元素宽高 */\r\n    private itemSize: cc.Size = cc.size(162, 154);\r\n\r\n    /** 元素总量 */\r\n    itemNum: number = 20;\r\n\r\n    /** 元素类别数量 */\r\n    itemTypeNum: number = 21;\r\n\r\n    /** 遮罩长度 */\r\n    maskLength: number = 0;\r\n\r\n    public index: number = 0;\r\n\r\n    start() {\r\n        this.maskLength = cc.find('barBg/mask', this.timerNode).width;\r\n        DataManager.curGameIsRun = false;\r\n        DataManager.gameLayerScr = this;\r\n        DataManager.curWinNum = 0;\r\n        this.updateUserCoin();\r\n        this.updateSoundBtnState();\r\n        DataManager.indexTime = DataManager.startTime;\r\n    }\r\n    /**\r\n     * 游戏内按钮绑定事件\r\n     */\r\n    btnEvent(event: cc.Event) {\r\n        let name = event.target.name;\r\n\r\n        this.playSound(0);\r\n        switch (name) {\r\n            case 'btnStartGame':\r\n                this.playGame();\r\n                break;\r\n            case 'btnReturn':\r\n                cc.director.loadScene('startGame');\r\n                break;\r\n            case 'btNextGame':\r\n            case 'btStartOver':\r\n                this.hideResultNode();\r\n                break;\r\n            case 'btExit':\r\n                cc.director.loadScene('startGame');\r\n                break;\r\n            case 'btnHelp':\r\n                this.tipNode.active = true;\r\n                break;\r\n            case 'btnCloseHelp':\r\n                this.hideTipNode();\r\n            case 'btnBgSound':\r\n                DataManager.isOpenBgSound = !DataManager.isOpenBgSound;\r\n                cc.find('Canvas').getComponent(cc.AudioSource).volume = DataManager.isOpenBgSound ? 1 : 0;\r\n                this.updateSoundBtnState();\r\n                break;\r\n            case 'btnEffectSound':\r\n                DataManager.isOpenEffectSound = !DataManager.isOpenEffectSound;\r\n                this.updateSoundBtnState();\r\n                break;\r\n        }\r\n    }\r\n\r\n    playSound(index) {\r\n        if (!DataManager.isOpenEffectSound) return;\r\n\r\n        this.node.getComponent(cc.AudioSource).clip = this.audios[index];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n    }\r\n\r\n    /**\r\n     * 更新音效按钮状态\r\n     */\r\n    updateSoundBtnState() {\r\n        let color1 = cc.color(179, 179, 179, 255);\r\n        let color2 = cc.color(255, 255, 255, 255);\r\n\r\n        cc.find('Canvas/gameLayer/topNode/btnBgSound').color = (DataManager.isOpenBgSound ? color2 : color1).clone();\r\n        cc.find('Canvas/gameLayer/topNode/btnEffectSound').color = (DataManager.isOpenEffectSound ? color2 : color1).clone();\r\n    }\r\n\r\n    /** 开始游戏 */\r\n    playGame() {\r\n        if (DataManager.curGameIsRun) return;\r\n        DataManager.curGameIsRun = true;\r\n\r\n        this.playSound(0);\r\n        this.initItemNode();\r\n        this.startTimer();\r\n    }\r\n\r\n    /**\r\n     * 初始化游戏节点\r\n     */\r\n    initItemNode() {\r\n        let dataList1 = this.getStartGameData();\r\n        let dataList2 = this.changeGameData(dataList1);\r\n\r\n        this.addItemByData(this.LLayer.getChildByName('itemParent'), dataList1);\r\n        this.addItemByData(this.RLayer.getChildByName('itemParent'), dataList2);\r\n\r\n        this.RLayer.getChildByName('itemParent').children.forEach((node, i) =>\r\n            node.on(cc.Node.EventType.TOUCH_END, () => {\r\n                if (i == DataManager.curWinItmeIndex) {\r\n                    DataManager.curScord += 100;\r\n                    this.playSound(4);\r\n                    cc.tween(node)\r\n                        .to(0.7, { scale: 0.7, opacity: 0 })\r\n                        .call(() => {\r\n                            this.showResult(true);\r\n                        })\r\n                        .start();\r\n                } else {\r\n                    this.playSound(3);\r\n                    cc.tween(node).to(0.1, { rotation: 10 }).to(0.1, { rotation: -10 }).to(0.1, { rotation: 0 }).start();\r\n                    console.log('选错了');\r\n                }\r\n            })\r\n        );\r\n    }\r\n\r\n    /**\r\n     * 根据数据给节点添加元素\r\n     */\r\n    addItemByData(node, data) {\r\n        for (let i: number = 0; i < data.length; i++) {\r\n            let itemNode = cc.instantiate(this.itemPrefab);\r\n\r\n            itemNode.getComponent(ItemNode).init(data[i].toString(), this.itemSize);\r\n            node.addChild(itemNode);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取初始游戏数据\r\n     */\r\n    getStartGameData() {\r\n        let gameData = [];\r\n\r\n        for (let i: number = 0; i < this.itemNum; i++) {\r\n            let itemId = util.getRandom(1, this.itemTypeNum);\r\n            gameData.push(itemId);\r\n        }\r\n\r\n        return gameData;\r\n    }\r\n\r\n    /**\r\n     * 根据数据修改一个值并返回\r\n     */\r\n    changeGameData(gameDataList) {\r\n        let newDataList = [];\r\n        let changeIndex = util.getRandom(0, gameDataList.length - 1);\r\n        let curItemId = gameDataList[changeIndex];\r\n        let getId = () => {\r\n            let id = util.getRandom(1, this.itemTypeNum);\r\n            if (id == curItemId) {\r\n                id = getId();\r\n            }\r\n\r\n            return id;\r\n        };\r\n        let changeId = getId();\r\n\r\n        for (let i: number = 0; i < gameDataList.length; i++) {\r\n            if (i == changeIndex) {\r\n                newDataList.push(changeId);\r\n            } else {\r\n                newDataList.push(gameDataList[i]);\r\n            }\r\n        }\r\n\r\n        DataManager.curWinItmeIndex = changeIndex;\r\n\r\n        return newDataList;\r\n    }\r\n\r\n    /**\r\n     * 重置游戏节点\r\n     */\r\n    resetGameNode() {\r\n        this.LLayer.getChildByName('itemParent').removeAllChildren();\r\n        this.RLayer.getChildByName('itemParent').removeAllChildren();\r\n        DataManager.curWinItmeIndex = -1;\r\n    }\r\n\r\n    /**\r\n     * 开始倒计时\r\n     */\r\n    startTimer() {\r\n        let speed = 0.01;\r\n\r\n        DataManager.timerFunc = () => {\r\n            DataManager.indexTime -= speed;\r\n            if (DataManager.indexTime <= 0) {\r\n                this.showResult(false);\r\n            }\r\n        };\r\n        this.schedule(DataManager.timerFunc, speed);\r\n    }\r\n\r\n    /**\r\n     * 更新倒计时\r\n     */\r\n    updateTimerUi() {\r\n        cc.find('barBg/mask', this.timerNode).width = (DataManager.indexTime / DataManager.startTime) * this.maskLength;\r\n        this.timerNode.getChildByName('timeText').getComponent(cc.Label).string = '00:' + Math.ceil(DataManager.indexTime);\r\n    }\r\n\r\n    /**\r\n     * 更新余额\r\n     */\r\n    updateUserCoin() {\r\n        let lableNode = this.userCoinNode.getChildByName('coinLable');\r\n\r\n        cc.tween(lableNode).to(0.1, { scale: 1.1 }).to(0.1, { scale: 1 }).start();\r\n        lableNode.getComponent(cc.Label).string = '' + DataManager.curScord;\r\n    }\r\n\r\n    /**\r\n     * 展示结果\r\n     */\r\n    showResult(isWin) {\r\n        this.playSound(isWin ? 2 : 1);\r\n        this.unschedule(DataManager.timerFunc);\r\n        DataManager.indexTime = DataManager.startTime;\r\n        this.resetGameNode();\r\n        DataManager.curWinNum += 100;\r\n        if (isWin) {\r\n            let winNumLable = cc.find('win/winNum', this.resultNode);\r\n\r\n            winNumLable.getComponent(cc.Label).string = '' + DataManager.curWinNum;\r\n        }\r\n\r\n        let winNode = this.resultNode.getChildByName('win');\r\n        let loseNode = this.resultNode.getChildByName('lose');\r\n\r\n        winNode.active = isWin;\r\n        loseNode.active = !isWin;\r\n        let curAniNode = isWin ? winNode : loseNode;\r\n\r\n        this.resultNode.active = true;\r\n\r\n        curAniNode.scale = 0.6;\r\n        curAniNode.opacity = 100;\r\n\r\n        cc.tween(curAniNode).to(0.3, { scale: 1.1, opacity: 255 }).to(0.3, { scale: 1 }).start();\r\n    }\r\n\r\n    /**\r\n     * 关闭结果展示\r\n     */\r\n    hideResultNode() {\r\n        cc.find('barBg/mask', this.timerNode).width = this.maskLength;\r\n        DataManager.curGameIsRun = false;\r\n        this.resultNode.active = false;\r\n        DataManager.curWinNum = 0;\r\n    }\r\n\r\n    /**\r\n     * 关闭提示展示\r\n     */\r\n    hideTipNode() {\r\n        cc.tween(this.tipNode.getChildByName('helpText'))\r\n            .to(0.2, { scale: 0.5 })\r\n            .call(() => {\r\n                this.tipNode.active = false;\r\n                this.tipNode.getChildByName('helpText').scale = 1;\r\n            })\r\n            .start();\r\n    }\r\n}\r\n"]}