{"version":3,"sources":["assets\\script\\GameLayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DataManager from './DataManager';\r\nimport GameWheel from './GameWheel';\r\nimport ItemNode from './ItemNode';\r\nimport { DirectionType, EventId } from './util/define';\r\nimport EventMgr from './util/event/EventMgr';\r\nimport loaderManager from './util/loaderManager';\r\nimport util from './util/util';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameLayer extends cc.Component {\r\n    @property({ type: [cc.SpriteFrame], tooltip: '元素纹理' })\r\n    itemResList: cc.SpriteFrame[] = [];\r\n\r\n    @property({ type: cc.Node, tooltip: '用户余额节点' })\r\n    userCoinNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏提示页面' })\r\n    tipNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏结果节点' })\r\n    resultNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '倒计时节点' })\r\n    timerNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '音效按钮节点' })\r\n    soundBtn: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '音效按钮节点' })\r\n    musicBtn: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '开始游戏节点' })\r\n    playBtn: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏格子' })\r\n    gzPos: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏格子' })\r\n    gamePos: cc.Node = null;\r\n\r\n    @property({ type: [cc.AudioClip] })\r\n    audioResList: cc.AudioClip[] = [];\r\n\r\n    public iconPf: cc.Prefab = null;\r\n\r\n    public index: number = 0;\r\n\r\n    private colNum = 4;\r\n    private rowNum = 4;\r\n\r\n    private callTimer;\r\n\r\n    /** 已绘制线数组 */\r\n    alreadyDrawLineList: Array<Array<number>> = [];\r\n\r\n    /** 当前绘制线数组 */\r\n    curDrawLineItmeIndex: Array<number> = [];\r\n\r\n    list: Array<number> = [];\r\n    /**加载预制体 */\r\n    async loadCard() {\r\n        this.iconPf = await loaderManager.getRes('item', 'prefab', cc.Prefab);\r\n        if (this.iconPf) {\r\n            console.log('预制体加载成功！');\r\n        }\r\n    }\r\n\r\n    start() {\r\n        this.updateUserCoin();\r\n        this.updateTimerUi();\r\n        // this.loadCard()\r\n        // this.listerEvent()\r\n    }\r\n    protected onEnable(): void {\r\n        this.scheduleOnce(() => {\r\n            this.schedule(() => {\r\n                if (DataManager.Adjust_status == '') return;\r\n                if (DataManager.Adjust_status.toLowerCase() !== 'organic') {\r\n                    // 字符串不为空且不为 \"organic\" 或 \"Organic\"，执行你的操作\r\n                    DataManager.adAnalyseAjustHandle();\r\n                } else {\r\n                    DataManager.adGoogleOpenAdHandle();\r\n                }\r\n                this.unscheduleAllCallbacks();\r\n            }, 1.5);\r\n        }, 0.5);\r\n    }\r\n    //绑定事件\r\n    listerEvent() {\r\n        EventMgr.Instance.Register(EventId.Result, this.showResult, this);\r\n    }\r\n\r\n    /**\r\n     * 清除事件\r\n     */\r\n    cleatEvent() {\r\n        EventMgr.Instance.Off();\r\n    }\r\n    /**\r\n     * 游戏内按钮绑定事件\r\n     */\r\n    btnEvent(event: cc.Event) {\r\n        let name = event.target.name;\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[0];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        switch (name) {\r\n            case 'btnStartGame':\r\n                DataManager.adGoogleInterstitialAdHandle();\r\n                this.playGame();\r\n                break;\r\n            case 'btnReturn':\r\n                DataManager.adGoogleInterstitialAdHandle();\r\n                this.hideResultNode();\r\n                this.cleatEvent();\r\n                cc.director.loadScene('a_startGame');\r\n                break;\r\n            case 'btNextGame':\r\n            case 'btStartOver':\r\n                DataManager.adGoogleInterstitialAdHandle();\r\n                this.hideResultNode();\r\n                break;\r\n            case 'btExit':\r\n                DataManager.adGoogleInterstitialAdHandle();\r\n                this.hideResultNode();\r\n                this.cleatEvent();\r\n                cc.director.loadScene('a_startGame');\r\n                break;\r\n            case 'tipBtn':\r\n                DataManager.adGoogleInterstitialAdHandle();\r\n                this.openTipNode();\r\n                break;\r\n            case 'adsBtn':\r\n                DataManager.adGoogleRewardedVideoAdHandle();\r\n                break;\r\n            case 'closeTipBtn':\r\n                DataManager.adGoogleInterstitialAdHandle();\r\n                this.hideTipNode();\r\n                break;\r\n            case 'btnSound':\r\n                this.openOrCloseSound();\r\n                break;\r\n            case 'musicBtn':\r\n                this.openOrCloseBG();\r\n                break;\r\n        }\r\n    }\r\n\r\n    /** 开始游戏 */\r\n    playGame() {\r\n        if (DataManager.curGameIsRun) return;\r\n        DataManager.curGameIsRun = true;\r\n        // cc.director.getCollisionManager().enabled = true;\r\n        // 计时器\r\n        this.startTimer();\r\n        //隐藏游戏按钮\r\n        // this.playBtn.active = false\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[2];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        //游戏逻辑\r\n        let numArray = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];\r\n        let randomList = util.getRandomListItme(numArray, 20, false);\r\n        this.list = randomList;\r\n        // for(let i=0;i<randomList.length;i++){\r\n        //     this.creatLaber(i,randomList[i])\r\n        // }\r\n        this.creatLaber();\r\n        for (let i = 0; i < randomList.length; i++) {\r\n            this.creatFish(i, randomList[i], this.gzPos.children[i]);\r\n        }\r\n    }\r\n    creatFish(index: number, randoList: number, Node: cc.Node) {\r\n        Node.getComponent(cc.Sprite).spriteFrame = this.itemResList[randoList];\r\n        Node.on(cc.Node.EventType.TOUCH_END, () => {\r\n            console.log('当前点击的', randoList, DataManager.tipNum);\r\n            if (randoList == DataManager.tipNum) {\r\n                /**消除成功 */\r\n                this.unschedule(this.callTimer);\r\n                this.creatLaber();\r\n                DataManager._curScord += 100;\r\n                this.updataCoin();\r\n                let index = util.getRandom(0, 15);\r\n                randoList = index;\r\n                Node.getComponent(cc.Sprite).spriteFrame = this.itemResList[randoList];\r\n            }\r\n        });\r\n    }\r\n    /**创建文字 */\r\n    creatLaber() {\r\n        cc.tween(this.gamePos.children[0])\r\n            .to(0.1, { scale: 1.5 })\r\n            .to(0.2, { scale: 1 })\r\n            .call(() => {\r\n                let num = util.getRandom(0, 15);\r\n                this.gamePos.children[0].getComponent(cc.Sprite).spriteFrame = this.itemResList[num];\r\n                DataManager.tipNum = num;\r\n            })\r\n            .start();\r\n        this.callTimer = () => {\r\n            let num = util.getRandom(0, 15);\r\n            this.gamePos.children[0].getComponent(cc.Sprite).spriteFrame = this.itemResList[num];\r\n            DataManager.tipNum = num;\r\n        };\r\n        this.schedule(this.callTimer, 3);\r\n    }\r\n\r\n    /**绑定滑动事件 */\r\n    listTouchEvent(TouchNode: cc.Node) {\r\n        TouchNode.on(cc.Node.EventType.TOUCH_START, (event) => {\r\n            TouchNode['startPos'] = cc.v2(event.getLocation().x, event.getLocation().y);\r\n        });\r\n        TouchNode.on(cc.Node.EventType.TOUCH_CANCEL, (event) => {\r\n            let statPos = TouchNode['startPos'];\r\n            let endPos = cc.v2(event.getLocation().x, event.getLocation().y);\r\n            let direction = this.isDirection(statPos, endPos);\r\n            if (direction) {\r\n                this.TouchMove(TouchNode, direction);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**移动事件 */\r\n    TouchMove(taget: cc.Node, direction: DirectionType) {\r\n        let itemIndex = taget.getComponent(ItemNode).itemIndex;\r\n        let moveId = itemIndex;\r\n        let otherNode: cc.Node = null;\r\n        DataManager._curScord += 1;\r\n        this.updataCoin();\r\n        switch (direction) {\r\n            case DirectionType.Top:\r\n                console.log('上');\r\n                if (itemIndex - this.colNum >= 0) {\r\n                    moveId = itemIndex - this.colNum;\r\n                }\r\n                break;\r\n            case DirectionType.Bottom:\r\n                console.log('下');\r\n                if (itemIndex + this.colNum <= this.gzPos.children.length) {\r\n                    moveId = itemIndex + this.colNum;\r\n                }\r\n                break;\r\n            case DirectionType.Left:\r\n                console.log('左');\r\n                if ((itemIndex % this.colNum) - 1 >= 0) {\r\n                    moveId = itemIndex - 1;\r\n                }\r\n                break;\r\n            case DirectionType.Right:\r\n                console.log('右');\r\n                if ((itemIndex % this.colNum) + 1 <= this.colNum) {\r\n                    moveId = itemIndex + 1;\r\n                }\r\n                break;\r\n        }\r\n        this.gamePos.children.forEach((e) => {\r\n            if (e.getComponent(ItemNode).itemIndex == moveId) {\r\n                otherNode = e;\r\n            }\r\n        });\r\n\r\n        if (otherNode) {\r\n            cc.tween(taget).to(0.2, { position: this.gzPos.children[moveId].position }).start();\r\n            cc.tween(otherNode).to(0.2, { position: this.gzPos.children[itemIndex].position }).start();\r\n            this.scheduleOnce(() => {\r\n                taget.getComponent(ItemNode).itemIndex = moveId;\r\n                otherNode.getComponent(ItemNode).itemIndex = itemIndex;\r\n                let tagetId = util.copyObj(taget.getComponent(ItemNode).itemId);\r\n                taget.getComponent(ItemNode).itemId = otherNode.getComponent(ItemNode).itemId;\r\n                otherNode.getComponent(ItemNode).itemId = tagetId;\r\n                let ARR = [];\r\n                this.gamePos.children.forEach((e, i) => {\r\n                    ARR.push(e.getComponent(ItemNode).itemId);\r\n                    this.showResult(true);\r\n                });\r\n            }, 0.3);\r\n        }\r\n    }\r\n\r\n    /**更新实际类型 */\r\n    updataIndex() {\r\n        for (let i = 0; i < this.gamePos.children.length - 1; i++) {\r\n            if (this.gamePos.children[i].getComponent(ItemNode).itemIndex == i) {\r\n            }\r\n        }\r\n    }\r\n\r\n    /**判断方向 */\r\n    isDirection(startPos: cc.Vec2, endPos: cc.Vec2): DirectionType {\r\n        let direction: DirectionType = DirectionType.Left;\r\n        let offsetX = Math.abs(endPos.x - startPos.x);\r\n        let offsetY = Math.abs(endPos.y - startPos.y);\r\n        if (offsetX >= offsetY) {\r\n            direction = endPos.x > startPos.x ? DirectionType.Right : DirectionType.Left;\r\n        } else {\r\n            direction = endPos.y > startPos.y ? DirectionType.Top : DirectionType.Bottom;\r\n        }\r\n        return direction;\r\n    }\r\n\r\n    /**\r\n     * 获取当前世界坐标上的item\r\n     */\r\n    getCurWorldPosItem(curPos: cc.Vec2) {\r\n        let returnItem = null;\r\n        this.gamePos.children.forEach((item) => {\r\n            let itemWorldPos = item.convertToWorldSpaceAR(cc.v2(0, 0));\r\n            let size = item.getContentSize();\r\n\r\n            if (curPos.x > itemWorldPos.x - size.width && curPos.x < itemWorldPos.x + size.width && curPos.y > itemWorldPos.y - size.height && curPos.y < itemWorldPos.y + size.height) {\r\n                // 在节点内\r\n                returnItem = item;\r\n            }\r\n        });\r\n        return returnItem;\r\n    }\r\n\r\n    /**\r\n     * 开启或关闭音效\r\n     */\r\n    openOrCloseSound() {\r\n        if (DataManager.curSoundBGIsClose) {\r\n            this.soundBtn.color = cc.color(170, 170, 170, 255);\r\n            this.node.getComponent(cc.AudioSource).volume = 0;\r\n        } else {\r\n            this.soundBtn.color = cc.color(255, 255, 255, 255);\r\n            this.node.getComponent(cc.AudioSource).volume = 1;\r\n        }\r\n        DataManager.curSoundBGIsClose = !DataManager.curSoundBGIsClose;\r\n    }\r\n\r\n    openOrCloseBG() {\r\n        if (DataManager.curSoundIsClose) {\r\n            this.musicBtn.color = cc.color(170, 170, 170, 255);\r\n            cc.find('Canvas').getComponent(cc.AudioSource).volume = 0;\r\n        } else {\r\n            this.musicBtn.color = cc.color(255, 255, 255, 255);\r\n            cc.find('Canvas').getComponent(cc.AudioSource).volume = 1;\r\n        }\r\n\r\n        DataManager.curSoundIsClose = !DataManager.curSoundIsClose;\r\n    }\r\n    /**\r\n     * 开始倒计时\r\n     */\r\n    startTimer() {\r\n        let speed = 0.01;\r\n        DataManager.timerFunc = () => {\r\n            DataManager.indexTime -= speed;\r\n            if (DataManager.indexTime <= 0) {\r\n                this.ResultFn();\r\n            }\r\n            this.updateTimerUi();\r\n            this.timerNode.getChildByName('timeText').getComponent(cc.Label).string = Math.floor(DataManager.indexTime) + 's';\r\n        };\r\n        this.schedule(DataManager.timerFunc, speed);\r\n    }\r\n\r\n    /**\r\n     * 更新倒计时\r\n     */\r\n    updateTimerUi() {\r\n        cc.find('barBg/bar', this.timerNode).getComponent(cc.Sprite).fillRange = DataManager.indexTime / DataManager.startTime;\r\n        this.timerNode.getChildByName('timeText').getComponent(cc.Label).string = Math.ceil(DataManager.indexTime) + 's';\r\n    }\r\n\r\n    updataCoin() {\r\n        this.updateUserCoin();\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[2];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        // this.keyNode.getComponent(cc.Label).string = DataManager.keyNum + ''\r\n    }\r\n\r\n    /**\r\n     * 更新余额\r\n     */\r\n    updateUserCoin() {\r\n        let lableNode = this.userCoinNode.getChildByName('coinLable');\r\n        cc.tween(lableNode).to(0.1, { scale: 1.1 }).to(0.1, { scale: 1 }).start();\r\n        lableNode.getComponent(cc.Label).string = '' + DataManager.curScord;\r\n    }\r\n\r\n    /**判断结果 */\r\n    ResultFn() {\r\n        if (DataManager._curScord >= 1000) {\r\n            this.showResult(true);\r\n            DataManager.curWinNum += 200;\r\n        } else {\r\n            this.showResult(false);\r\n        }\r\n    }\r\n\r\n    /**打开提示 */\r\n    openTipNode() {\r\n        this.tipNode.getChildByName('rule').scale = 0.8;\r\n        this.tipNode.active = true;\r\n        cc.tween(this.tipNode.getChildByName('rule')).to(0.2, { scale: 1 }).start();\r\n    }\r\n\r\n    /**\r\n     * 关闭提示展示\r\n     */\r\n    hideTipNode() {\r\n        cc.tween(this.tipNode.getChildByName('rule'))\r\n            .to(0.2, { scale: 0.5 })\r\n            .call(() => {\r\n                this.tipNode.active = false;\r\n                this.tipNode.getChildByName('rule').scale = 1;\r\n            })\r\n            .start();\r\n    }\r\n\r\n    /**\r\n     * 展示结果\r\n     */\r\n    showResult(isWin) {\r\n        this.unschedule(DataManager.timerFunc);\r\n        this.unscheduleAllCallbacks();\r\n        this.gzPos.children.forEach((e) => {\r\n            e.off(cc.Node.EventType.TOUCH_END);\r\n        });\r\n        DataManager.indexTime = DataManager.startTime;\r\n        if (isWin) {\r\n            let winNumLable = cc.find('win/winNum', this.resultNode);\r\n            DataManager.curWinNum += 100;\r\n            winNumLable.getComponent(cc.Label).string = '' + DataManager.curWinNum;\r\n        }\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[isWin ? 4 : 5];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        let winNode = this.resultNode.getChildByName('win');\r\n        let loseNode = this.resultNode.getChildByName('lose');\r\n        winNode.active = isWin;\r\n        loseNode.active = !isWin;\r\n        let curAniNode = isWin ? winNode : loseNode;\r\n        this.resultNode.active = true;\r\n        curAniNode.scale = 0.6;\r\n        curAniNode.opacity = 100;\r\n\r\n        cc.tween(curAniNode).to(0.3, { scale: 1.1, opacity: 255 }).to(0.3, { scale: 1 }).start();\r\n    }\r\n\r\n    /**\r\n     * 关闭结果展示\r\n     */\r\n    hideResultNode() {\r\n        DataManager.curGameIsRun = false;\r\n        this.resultNode.active = false;\r\n        cc.director.getCollisionManager().enabled = false;\r\n        DataManager._curScord = 0;\r\n        DataManager._indexTime = DataManager.startTime;\r\n        this.updateTimerUi();\r\n        this.updateUserCoin();\r\n    }\r\n}\r\n"]}