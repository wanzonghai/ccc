{"version":3,"sources":["assets\\script\\GameLayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DataManager from \"./DataManager\";\r\nimport Util from \"./util/Util\";\r\nimport { DirectionType, EventId } from \"./util/define\";\r\nimport loaderManager from \"./util/loaderManager\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameLayer extends cc.Component {\r\n\r\n    public static instance = new GameLayer();\r\n\r\n    @property({type: cc.Node, tooltip: \"放置元素的layout\"})\r\n    itemParentNode: cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"用户余额节点\"})\r\n    userCoinNode: cc.Node = null\r\n\r\n    @property({type:cc.Node,tooltip:\"游戏节点\"})\r\n    itemNode:cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"游戏结果节点\"})\r\n    resultNode: cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"游戏提示节点\"})\r\n    tipNode: cc.Node = null\r\n    \r\n    @property({type: cc.Node, tooltip: \"倒计时节点\"})\r\n    timerNode: cc.Node = null\r\n\r\n    @property({type: [cc.SpriteFrame], tooltip: \"元素纹理\"})\r\n    itemSpriteFrameList: cc.SpriteFrame[] = [];\r\n    \r\n    @property({type: cc.Node, tooltip: \"元素父节点\"})\r\n    itemParent: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    ballNode:cc.Node = null\r\n\r\n    @property([cc.AudioClip])\r\n    clipArray:cc.AudioClip[] = []\r\n\r\n    /** 行数 */\r\n    rowNum = 4;\r\n\r\n    /** 列数 */\r\n    colNum = 8;\r\n\r\n    /** 元素大小 */\r\n    itemSize: cc.Size = cc.size(0, 0);\r\n\r\n    /** 元素缩放 */\r\n    itemScale: number = 0.96;\r\n\r\n    /** 元素间距X */\r\n    itemIntervalX: number = 0;\r\n\r\n    /** 元素间距Y */\r\n    itemIntervalY: number = 0;\r\n\r\n    // /** 元素宽高 */\r\n    // private itemSize: cc.Size = cc.size(360, 150);\r\n\r\n    /** 元素总量 */\r\n    itemNum: number = 12;\r\n\r\n    /** 元素类别数量 */\r\n    itemTypeNum: number = 6;\r\n\r\n    public index:number = 0\r\n\r\n    public iconPf:cc.Prefab = null\r\n\r\n     /**加载卡片 */\r\n    async loadCard(){\r\n        this.iconPf =  await loaderManager.getRes(\"gen\",\"prefab\",cc.Prefab)\r\n        if(this.iconPf){\r\n            console.log(\"预制体加载成功！\");\r\n            \r\n        }\r\n    }\r\n\r\n    start () { \r\n        DataManager.gameLayerScr = this;\r\n        DataManager.curWinNum = 0;\r\n        this.updateUserCoin();\r\n        this.updateTimerUi()\r\n\r\n        //画格子\r\n        for(let i: number = 0; i < this.itemSpriteFrameList.length; i++) {\r\n            this.itemSpriteFrameList[i].getRect().width > this.itemSize.width && (this.itemSize.width = this.itemSpriteFrameList[i].getRect().width)\r\n            this.itemSpriteFrameList[i].getRect().height > this.itemSize.height && (this.itemSize.height = this.itemSpriteFrameList[i].getRect().height)\r\n        }\r\n        this.itemParent[\"startPos\"] = cc.v3(this.itemParent.position.x, this.itemParent.position.y);\r\n        this.creatorItemNode();\r\n    }\r\n\r\n    /**\r\n     * 创建item节点\r\n    */\r\n    creatorItemNode() {\r\n        for(let i: number = 0; i < this.rowNum * this.colNum; i++) {\r\n            let itemNode = new cc.Node();\r\n            itemNode.addComponent(cc.Sprite);\r\n            let row = Math.floor(i / this.colNum);\r\n            let col = i % this.colNum;\r\n            let itemWidth = this.itemSize.width * this.itemScale;\r\n            let itemHeight = this.itemSize.height * this.itemScale;\r\n\r\n            itemNode.scale = this.itemScale\r\n            itemNode[\"curIndex\"] = i;\r\n            this.itemParent.addChild(itemNode);\r\n            itemNode.position = cc.v3(itemWidth / 2 + col * itemWidth + col * this.itemIntervalX, itemHeight / 2 + (this.rowNum - row - 1) * itemHeight + (this.rowNum - row - 1) * this.itemIntervalY);\r\n            itemNode[\"startPos\"] = cc.v3(itemWidth / 2 + col * itemWidth + col * this.itemIntervalX, itemHeight / 2 + (this.rowNum - row - 1) * itemHeight + (this.rowNum - row - 1) * this.itemIntervalY);\r\n          \r\n        }\r\n\r\n        this.initGameData();\r\n    }\r\n\r\n     /**\r\n     * 初始化节点数据\r\n    */\r\n     initGameData() {\r\n        let curId = 1;\r\n        for(let i: number = 0; i < this.rowNum * this.colNum; i++) {\r\n            let itemNode = this.itemParent.children[i];\r\n            itemNode[\"itemId\"] = curId;\r\n            itemNode.getComponent(cc.Sprite).spriteFrame = this.itemSpriteFrameList[curId - 1];\r\n            curId = curId == 1 ? 2 : 1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 游戏内按钮绑定事件\r\n    */\r\n    btnEvent(event: cc.Event) {\r\n        let name = event.target.name;\r\n        switch(name) {\r\n            case \"btnStartGame\":\r\n                this.playGame();\r\n                break;\r\n            case \"btnReturn\":\r\n                cc.director.loadScene(\"startGame\");\r\n                DataManager.curGameIsRun = false;\r\n                this.hideResultNode()\r\n                break;\r\n            case \"btNextGame\":\r\n            case \"btStartOver\":\r\n                this.hideResultNode();\r\n                break;\r\n            case \"btExit\":\r\n                cc.director.loadScene(\"startGame\");\r\n                DataManager.curGameIsRun = false;\r\n                this.hideResultNode()\r\n                break;\r\n            case \"btnHelp\":\r\n                this.tipNode.active = true;\r\n                break;\r\n            case \"btnCloseHelp\":\r\n                this.hideTipNode();\r\n                break;\r\n        }\r\n        cc.audioEngine.playEffect(this.clipArray[0],false)\r\n    }\r\n\r\n\r\n    /** 开始游戏 */\r\n    playGame(){\r\n        if(DataManager.curGameIsRun) return\r\n        DataManager.curGameIsRun = true;\r\n        cc.audioEngine.playEffect(this.clipArray[0],false)\r\n        this.startTimer();\r\n        //创建游戏节点\r\n        // this.creatGameNode()\r\n        console.log(\"this.itemNode\",this.itemNode);\r\n        this.listBall()\r\n        //随机创建障碍物\r\n        this.randObs() \r\n    }\r\n    /**随机创建障碍物 */\r\n    randObs(){\r\n        DataManager.gamePos[0]  = Util.getRandomInt(1,30)\r\n        DataManager.gamePos[1]  = Util.getRandomInt(1,30)\r\n        DataManager.gamePos[2]  = Util.getRandomInt(1,30)\r\n        DataManager.gamePos[3]  = Util.getRandomInt(1,30)\r\n        DataManager.gamePos[4]  = Util.getRandomInt(1,30)\r\n        DataManager.gamePos.forEach(e=>{\r\n            this.itemParentNode.children[e].active = true\r\n        })\r\n        \r\n    }\r\n    /**绑定球事件 */\r\n    listBall(){\r\n        this.ballNode.on(cc.Node.EventType.TOUCH_START,(event)=>{\r\n            this.ballNode[\"startPos\"] = cc.v2(event.getLocation().x, event.getLocation().y)\r\n         })\r\n         this.ballNode.on(cc.Node.EventType.TOUCH_CANCEL,(event)=>{\r\n            let statPos =  this.ballNode[\"startPos\"]\r\n            let endPos = cc.v2(event.getLocation().x,event.getLocation().y)\r\n            let direction = this.isDirection(statPos,endPos)\r\n             cc.audioEngine.playEffect(this.clipArray[1],false)\r\n            if(direction){\r\n                this.movingBone( this.ballNode,direction)\r\n            }\r\n         })\r\n    }\r\n    /**滑块移动方向 */\r\n    movingBone(taget:cc.Node,direction:DirectionType){\r\n        let moveindx:number\r\n        // console.log(\"DataManager.index\",DataManager.index);\r\n        switch(direction){\r\n            case DirectionType.Top:\r\n                console.log(\"上\");\r\n                if(DataManager.index >= this.colNum){\r\n                    moveindx = DataManager.index - this.colNum\r\n                }\r\n            break;\r\n            case DirectionType.Bottom:\r\n                console.log(\"下\");\r\n                if(DataManager.index <= this.rowNum * this.colNum){\r\n                    moveindx = DataManager.index + this.colNum\r\n                }\r\n            break;\r\n            case DirectionType.Left:\r\n                console.log(\"左\");\r\n                if((DataManager.index) % this.colNum >= 0){\r\n                    moveindx = DataManager.index - 1\r\n                    if(moveindx < 0){\r\n                        moveindx = 0\r\n                    }\r\n                }\r\n            break;\r\n            case DirectionType.Right:\r\n                console.log(\"右\");\r\n                if((DataManager.index) % this.colNum < this.colNum - 1){\r\n                    moveindx = DataManager.index + 1\r\n                }\r\n            break;\r\n           \r\n        }\r\n        \r\n        if(moveindx!=undefined && moveindx!=DataManager.gamePos[0] && moveindx!=DataManager.gamePos[1] && moveindx!=DataManager.gamePos[2] && moveindx!=DataManager.gamePos[3] && moveindx!=DataManager.gamePos[4]){\r\n            cc.tween(taget)\r\n            .to(0.3,{position:this.itemParentNode.children[moveindx].position})\r\n            .call(()=>{\r\n                DataManager.index= moveindx\r\n                // console.log(\"DataManager.index\",DataManager.index);\r\n                if( DataManager.index == 31){\r\n                    this.showResult(true)\r\n                }\r\n            })\r\n            .start()\r\n        }\r\n        \r\n        // cc.tween(taget)\r\n    }\r\n\r\n    isDirection(startPos: cc.Vec2, endPos: cc.Vec2): DirectionType{\r\n        let direction: DirectionType = DirectionType.Left;\r\n        let offsetX = Math.abs(endPos.x - startPos.x);\r\n        let offsetY = Math.abs(endPos.y - startPos.y);\r\n        if(offsetX >= offsetY) {\r\n            direction = endPos.x > startPos.x ? DirectionType.Right : DirectionType.Left;\r\n        } else {\r\n            direction = endPos.y > startPos.y ? DirectionType.Top : DirectionType.Bottom;\r\n        }\r\n        return direction;\r\n    }\r\n    /**停止篮筐 */\r\n    clearTween(){\r\n        this.node.stopAllActions()\r\n    }\r\n    /**\r\n     * 开始倒计时\r\n    */\r\n    startTimer() {\r\n        DataManager.timerFunc = () => {\r\n            DataManager.indexTime--;\r\n            if(DataManager.indexTime <= 0) {\r\n                cc.audioEngine.playEffect(this.clipArray[1],false)\r\n                this.showResult(false)\r\n            }\r\n        }\r\n        this.schedule(DataManager.timerFunc, 1);\r\n    }\r\n\r\n    \r\n    /**\r\n     * 更新倒计时\r\n    */\r\n    updateTimerUi() {\r\n        this.timerNode.getChildByName(\"timeText\").getComponent(cc.Label).string = \"TIME:\" + DataManager.indexTime;\r\n        this.timerNode.getComponent(cc.ProgressBar).progress = DataManager.indexTime / DataManager.startTime\r\n    }\r\n\r\n    /**更新Layout布局 */\r\n    updataLayout(){\r\n        if(DataManager.isLayout){\r\n            this.itemParentNode.getComponent(cc.Layout).type = cc.Layout.Type.GRID\r\n        }else{\r\n            this.itemParentNode.getComponent(cc.Layout).type = cc.Layout.Type.NONE\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 更新余额\r\n    */\r\n    updateUserCoin() {\r\n        let lableNode = this.userCoinNode.getChildByName(\"coinLable\");\r\n        cc.tween(lableNode)\r\n            .to(0.1, {scale: 1.1})\r\n            .to(0.1, {scale: 1})\r\n            .start();\r\n        lableNode.getComponent(cc.Label).string = \"SCORE:\" + DataManager.curScord;\r\n    }\r\n\r\n    /**结果判断 */\r\n    showRes(){\r\n        if(DataManager._curScord >=210){\r\n            this.showResult(true)\r\n        }else{\r\n            // this.showResult(true)\r\n            this.showResult(false)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 展示结果\r\n    */\r\n    showResult(isWin:boolean) {\r\n        this.unschedule(DataManager.timerFunc);\r\n        cc.director.getPhysicsManager().enabled = false;\r\n        cc.director.getCollisionManager().enabled = false\r\n        DataManager.indexTime = DataManager.startTime;\r\n        if(isWin) {\r\n            let winNumLable = cc.find(\"win/winNum\", this.resultNode);\r\n            winNumLable.getComponent(cc.Label).string = \"\" + DataManager.curWinNum;\r\n            cc.audioEngine.playEffect(this.clipArray[3],false)\r\n        }else{\r\n            cc.audioEngine.playEffect(this.clipArray[4],false)\r\n        }\r\n        let winNode = this.resultNode.getChildByName(\"win\");\r\n        let loseNode = this.resultNode.getChildByName(\"lose\");\r\n\r\n        winNode.active = isWin;\r\n        loseNode.active = !isWin;\r\n\r\n        this.resultNode.active = true;\r\n        \r\n\r\n    }\r\n\r\n    /**\r\n     * 关闭结果展示\r\n    */\r\n    hideResultNode() {\r\n        DataManager.gamePos = [0,0,0,0,0]\r\n        DataManager.index = 0\r\n        this.resultNode.active = false;\r\n        DataManager.curGameIsRun = false;\r\n        DataManager.curWinNum = 0;\r\n        DataManager.indexTime = DataManager.startTime\r\n        this.timerNode.getComponent(cc.ProgressBar).progress = 1\r\n        cc.director.getPhysicsManager().enabled = false\r\n        cc.director.getCollisionManager().enabled = false\r\n        this.clearTween()\r\n        // DataManager.selectPorkerArray[0] = -1\r\n    }\r\n\r\n    /**\r\n     * 关闭提示展示\r\n    */\r\n    hideTipNode() {\r\n        this.tipNode.active = false;\r\n    }\r\n}\r\n\r\n"]}