{"version":3,"sources":["assets\\script\\GameLayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DataManager from \"./DataManager\";\r\nimport GameWheel from \"./GameWheel\";\r\nimport ItemNode from \"./ItemNode\";\r\nimport playLayer from \"./playLayer\";\r\nimport { EventId } from \"./util/define\";\r\nimport EventMgr from \"./util/event/EventMgr\";\r\nimport loaderManager from \"./util/loaderManager\";\r\nimport util from \"./util/util\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameLayer extends cc.Component {\r\n\r\n    @property({type: [cc.SpriteFrame], tooltip: \"元素纹理\"})\r\n    itemResList: cc.SpriteFrame[] = [];\r\n\r\n    @property({type: cc.Node, tooltip: \"用户余额节点\"})\r\n    userCoinNode: cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"游戏提示页面\"})\r\n    tipNode: cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"游戏结果节点\"})\r\n    resultNode: cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"倒计时节点\"})\r\n    timerNode: cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"音效按钮节点\"})\r\n    soundBtn: cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"音效按钮节点\"})\r\n    musicBtn: cc.Node = null\r\n\r\n    @property({type: cc.Node, tooltip: \"开始游戏节点\"})\r\n    playBtn: cc.Node = null\r\n\r\n    @property({type: playLayer, tooltip: \"游戏逻辑控制脚本\"})\r\n    playScr: playLayer = null\r\n\r\n    @property({type: cc.Node, tooltip: \"玩家分数展示节点\"})\r\n    userScoreLabel: cc.Node = null;\r\n\r\n    @property({type: cc.Node, tooltip: \"剩余时间展示节点\"})\r\n    timeLabel: cc.Node = null;\r\n\r\n    @property({type: [cc.AudioClip]})\r\n    audioResList: cc.AudioClip[] = [];\r\n\r\n    public iconPf:cc.Prefab = null\r\n\r\n    public index:number = 0\r\n\r\n\r\n     /**加载卡片 */\r\n     async loadCard(){\r\n        this.iconPf =  await loaderManager.getRes(\"item\",\"prefab\",cc.Prefab)\r\n        if(this.iconPf){\r\n            console.log(\"预制体加载成功！\");\r\n            \r\n        }\r\n    }\r\n\r\n    start () { \r\n        DataManager.gameLayerScr = this;\r\n        this.playScr.node.scale = cc.winSize.height / 1080;\r\n        this.updateUserCoin();\r\n        this.updateTimerUi()\r\n        this.loadCard()\r\n        // this.listerEvent()\r\n    }\r\n    //绑定事件\r\n    listerEvent(){\r\n        EventMgr.Instance.Register(EventId.Result,this.showResult,this)\r\n    }\r\n\r\n    /**\r\n     * 清除事件\r\n     */\r\n    cleatEvent(){\r\n        EventMgr.Instance.Off()\r\n    }\r\n    /**\r\n     * 游戏内按钮绑定事件\r\n    */\r\n    btnEvent(event: cc.Event) {\r\n        let name = event.target.name;\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[0];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        switch(name) {\r\n            case \"btnStartGame\":\r\n                this.playGame();\r\n                break;\r\n            case \"btnReturn\":\r\n                this.hideResultNode();\r\n                this.cleatEvent()\r\n                cc.director.loadScene(\"hall\");\r\n                break;\r\n            case \"btNextGame\":\r\n            case \"btStartOver\":\r\n                this.hideResultNode();\r\n                break;\r\n            case \"btExit\":\r\n                this.hideResultNode();\r\n                this.cleatEvent()\r\n                cc.director.loadScene(\"hall\");\r\n                break;\r\n            case \"tipBtn\":\r\n                this.openTipNode()\r\n                break;\r\n            case \"closeTipBtn\":\r\n                this.hideTipNode();\r\n                break;\r\n            case \"btnSound\":\r\n                this.openOrCloseSound();\r\n                break;\r\n            case \"musicBtn\":\r\n                this.openOrCloseBG();\r\n                break;\r\n        }\r\n    }\r\n\r\n    /** 开始游戏 */\r\n    playGame(){\r\n        if(DataManager.curGameIsRun) return\r\n        DataManager.curGameIsRun = true;\r\n        cc.director.getCollisionManager().enabled = true;\r\n        // 计时器\r\n        this.startTimer();\r\n        //隐藏游戏按钮\r\n        // this.playBtn.active = false\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[2];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        //游戏逻辑\r\n        this.playScr.createRandomPuzzle();\r\n        \r\n    }\r\n\r\n \r\n    /**\r\n     * 开启或关闭音效\r\n    */\r\n    openOrCloseSound() {\r\n        if(DataManager.curSoundBGIsClose) {\r\n            this.soundBtn.color = cc.color(170, 170, 170, 255);\r\n            this.node.getComponent(cc.AudioSource).volume = 0;\r\n        } else {\r\n            this.soundBtn.color = cc.color(255, 255, 255, 255);\r\n            this.node.getComponent(cc.AudioSource).volume = 1;\r\n        }\r\n        DataManager.curSoundBGIsClose = !DataManager.curSoundBGIsClose;\r\n    }\r\n\r\n    openOrCloseBG() {\r\n        if(DataManager.curSoundIsClose) {\r\n            this.musicBtn.color = cc.color(170, 170, 170, 255);\r\n            cc.find(\"Canvas\").getComponent(cc.AudioSource).volume = 0;\r\n        } else {\r\n            this.musicBtn.color = cc.color(255, 255, 255, 255);\r\n            cc.find(\"Canvas\").getComponent(cc.AudioSource).volume = 1;\r\n        }\r\n\r\n        DataManager.curSoundIsClose = !DataManager.curSoundIsClose;\r\n    }\r\n    /**\r\n     * 开始倒计时\r\n    */\r\n    startTimer() {\r\n        let speed = 0.01;\r\n        DataManager.timerFunc = () => {\r\n            DataManager.indexTime -= speed;\r\n            if(DataManager.indexTime <= 0) {\r\n                this.ResultFn();\r\n            }\r\n            this.updateTimerUi()\r\n            this.timeLabel.getComponent(cc.Label).string = \"00:00:\"+Math.floor(DataManager.indexTime);\r\n        }\r\n        this.schedule(DataManager.timerFunc, speed);\r\n       \r\n    }\r\n\r\n    \r\n    /**\r\n     * 更新倒计时\r\n    */\r\n    updateTimerUi() {\r\n        // cc.find(\"barBg/bar\", this.timerNode).getComponent(cc.Sprite).fillRange = DataManager.indexTime / DataManager.startTime;\r\n        this.timeLabel.getComponent(cc.Label).string = \"00:00:\"+Math.ceil(DataManager.indexTime);\r\n    }\r\n\r\n    updataCoin(){\r\n        this.updateUserCoin()\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[2];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n    }\r\n\r\n    /**\r\n     * 更新余额\r\n    */\r\n    updateUserCoin() {\r\n        cc.tween(this.userScoreLabel)\r\n            .to(0.1, {scale: 1.1})\r\n            .to(0.1, {scale: 1})\r\n            .start();\r\n        this.userScoreLabel.getComponent(cc.Label).string = \"\" + DataManager.curScord;\r\n    }\r\n\r\n    /**判断结果 */\r\n    ResultFn(){\r\n        if(DataManager._curScord >= 1000){\r\n            this.showResult(true)\r\n        }else{\r\n            this.showResult(false)\r\n        }\r\n    }\r\n\r\n     /**打开提示 */\r\n     openTipNode(){\r\n        this.tipNode.getChildByName(\"rule\").scale = 0.8;\r\n        this.tipNode.active = true;\r\n        cc.tween(this.tipNode.getChildByName(\"rule\"))\r\n        .to(0.2, {scale: 1})\r\n        .start();\r\n    }\r\n\r\n       /**\r\n     * 关闭提示展示\r\n    */\r\n       hideTipNode() {\r\n        cc.tween(this.tipNode.getChildByName(\"rule\"))\r\n            .to(0.2, {scale: 0.5})\r\n            .call(() => {\r\n                this.tipNode.active = false;\r\n                this.tipNode.getChildByName(\"rule\").scale = 1;\r\n            })\r\n            .start();\r\n    }\r\n\r\n    /**\r\n     * 展示结果\r\n    */\r\n    showResult(isWin) {\r\n        this.unschedule(DataManager.timerFunc);\r\n        this.unscheduleAllCallbacks()\r\n\r\n        DataManager.indexTime = DataManager.startTime;\r\n        if(isWin) {\r\n            let winNumLable = cc.find(\"win/winNum\", this.resultNode);\r\n            DataManager.curWinNum += 100;\r\n            winNumLable.getComponent(cc.Label).string = \"\" + DataManager.curWinNum;\r\n        }\r\n\r\n        \r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[isWin ? 4 : 5];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n\r\n        let winNode = this.resultNode.getChildByName(\"win\");\r\n        let loseNode = this.resultNode.getChildByName(\"lose\");\r\n\r\n        winNode.active = isWin;\r\n        loseNode.active = !isWin;\r\n        let curAniNode = isWin ? winNode : loseNode;\r\n\r\n        this.resultNode.active = true;\r\n\r\n        curAniNode.scale = 0.6;\r\n        curAniNode.opacity = 100;\r\n\r\n        cc.tween(curAniNode)\r\n            .to(0.3, {scale: 1.1, opacity: 255})\r\n            .to(0.3, {scale: 1})\r\n            .start();\r\n\r\n    }\r\n  \r\n    /**\r\n     * 关闭结果展示\r\n    */\r\n    hideResultNode() {\r\n        DataManager.curGameIsRun = false;\r\n        this.resultNode.active = false;\r\n        cc.director.getCollisionManager().enabled = false;\r\n        DataManager._curScord = 0;\r\n        DataManager._indexTime = DataManager.startTime\r\n        this.updateTimerUi()\r\n        this.updateUserCoin()\r\n    }\r\n\r\n}\r\n\r\n"]}