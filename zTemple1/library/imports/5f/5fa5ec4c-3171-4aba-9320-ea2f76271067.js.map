{"version":3,"sources":["assets\\script\\GameLayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DataManager from './DataManager';\r\nimport GameWheel from './GameWheel';\r\nimport ItemNode from './ItemNode';\r\nimport { DirectionType, EventId } from './util/define';\r\nimport EventMgr from './util/event/EventMgr';\r\nimport loaderManager from './util/loaderManager';\r\nimport util from './util/util';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GameLayer extends cc.Component {\r\n    @property({ type: [cc.SpriteFrame], tooltip: '元素纹理' })\r\n    itemResList: cc.SpriteFrame[] = [];\r\n\r\n    @property({ type: cc.Node, tooltip: '用户余额节点' })\r\n    userCoinNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏提示页面' })\r\n    tipNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏结果节点' })\r\n    resultNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '倒计时节点' })\r\n    timerNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '音效按钮节点' })\r\n    soundBtn: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '音效按钮节点' })\r\n    musicBtn: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '开始游戏节点' })\r\n    playBtn: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏格子' })\r\n    gzPos: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '游戏格子' })\r\n    gamePos: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '玩家绘制展示节点' })\r\n    playDrawShowNode: cc.Node = null;\r\n\r\n    @property({ type: cc.Node, tooltip: '线展示节点' })\r\n    lineShowNode: cc.Node = null;\r\n\r\n    @property({ type: [cc.AudioClip] })\r\n    audioResList: cc.AudioClip[] = [];\r\n\r\n    /** 上一次绘制的格子 */\r\n    lastDrawCell: cc.Node = null;\r\n\r\n    public iconPf: cc.Prefab = null;\r\n\r\n    public index: number = 0;\r\n\r\n    private colNum = 11;\r\n    private rowNum = 5;\r\n\r\n    /** 已绘制线数组 */\r\n    alreadyDrawLineList: Array<Array<number>> = [];\r\n\r\n    /** 当前绘制线数组 */\r\n    curDrawLineItmeIndex: Array<number> = [];\r\n\r\n    /**加载卡片 */\r\n    async loadCard() {\r\n        this.iconPf = await loaderManager.getRes('item', 'prefab', cc.Prefab);\r\n        if (this.iconPf) {\r\n            console.log('预制体加载成功！');\r\n        }\r\n    }\r\n\r\n    start() {\r\n        this.updateUserCoin();\r\n        this.updateTimerUi();\r\n        this.loadCard();\r\n        // this.listerEvent()\r\n        this.bindingDrawVisualEvent();\r\n    }\r\n\r\n    //绑定事件\r\n    listerEvent() {\r\n        EventMgr.Instance.Register(EventId.Result, this.showResult, this);\r\n    }\r\n\r\n    /**\r\n     * 清除事件\r\n     */\r\n    cleatEvent() {\r\n        EventMgr.Instance.Off();\r\n    }\r\n    /**\r\n     * 游戏内按钮绑定事件\r\n     */\r\n    btnEvent(event: cc.Event) {\r\n        let name = event.target.name;\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[0];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        switch (name) {\r\n            case 'btnStartGame':\r\n                this.playGame();\r\n                break;\r\n            case 'btnReturn':\r\n                this.hideResultNode();\r\n                this.cleatEvent();\r\n                cc.director.loadScene('hall');\r\n                break;\r\n            case 'btNextGame':\r\n            case 'btStartOver':\r\n                this.hideResultNode();\r\n                break;\r\n            case 'btExit':\r\n                this.hideResultNode();\r\n                this.cleatEvent();\r\n                cc.director.loadScene('hall');\r\n                break;\r\n            case 'tipBtn':\r\n                this.openTipNode();\r\n                break;\r\n            case 'closeTipBtn':\r\n                this.hideTipNode();\r\n                break;\r\n            case 'btnSound':\r\n                this.openOrCloseSound();\r\n                break;\r\n            case 'musicBtn':\r\n                this.openOrCloseBG();\r\n                break;\r\n            case 'adsBtn':\r\n                DataManager.adGoogleRewardedVideoAdHandle();\r\n                break;\r\n        }\r\n    }\r\n\r\n    /** 开始游戏 */\r\n    playGame() {\r\n        if (DataManager.curGameIsRun) return;\r\n        DataManager.curGameIsRun = true;\r\n        // cc.director.getCollisionManager().enabled = true;\r\n        // 计时器\r\n        this.startTimer();\r\n        //隐藏游戏按钮\r\n        // this.playBtn.active = false\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[2];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        //游戏逻辑\r\n\r\n        for (let i = 0; i < this.gzPos.children.length; i++) {\r\n            this.creatBall(this.gzPos.children[i].position, i);\r\n        }\r\n    }\r\n\r\n    /**创建预制体 */\r\n    creatBall(pos: cc.Vec3, i: number) {\r\n        let ballNode = cc.instantiate(this.iconPf);\r\n        let index = util.getRandom(0, ballNode.getComponent(ItemNode).imgSpArr.length - 1);\r\n        ballNode.getComponent(ItemNode).init(index, i);\r\n        ballNode.setParent(this.gamePos);\r\n        ballNode.setPosition(pos);\r\n        // this.listTouchEvent(ballNode)\r\n    }\r\n\r\n    /**绑定滑动事件 */\r\n    listTouchEvent(TouchNode: cc.Node) {\r\n        TouchNode.on(cc.Node.EventType.TOUCH_START, (event) => {\r\n            TouchNode['startPos'] = cc.v2(event.getLocation().x, event.getLocation().y);\r\n        });\r\n        TouchNode.on(cc.Node.EventType.TOUCH_CANCEL, (event) => {\r\n            let statPos = TouchNode['startPos'];\r\n            let endPos = cc.v2(event.getLocation().x, event.getLocation().y);\r\n            let direction = this.isDirection(statPos, endPos);\r\n            if (direction) {\r\n                this.TouchMove(TouchNode, direction);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**移动事件 */\r\n    TouchMove(taget: cc.Node, direction: DirectionType) {\r\n        // console.log(\"taget\",taget);\r\n        switch (direction) {\r\n            case DirectionType.Top:\r\n                console.log('上');\r\n                break;\r\n            case DirectionType.Bottom:\r\n                console.log('下');\r\n                break;\r\n            case DirectionType.Left:\r\n                console.log('左');\r\n                break;\r\n            case DirectionType.Right:\r\n                console.log('右');\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**判断方向 */\r\n    isDirection(startPos: cc.Vec2, endPos: cc.Vec2): DirectionType {\r\n        let direction: DirectionType = DirectionType.Left;\r\n        let offsetX = Math.abs(endPos.x - startPos.x);\r\n        let offsetY = Math.abs(endPos.y - startPos.y);\r\n        if (offsetX >= offsetY) {\r\n            direction = endPos.x > startPos.x ? DirectionType.Right : DirectionType.Left;\r\n        } else {\r\n            direction = endPos.y > startPos.y ? DirectionType.Top : DirectionType.Bottom;\r\n        }\r\n        return direction;\r\n    }\r\n\r\n    /**\r\n     * 获取当前世界坐标上的item\r\n     */\r\n    getCurWorldPosItem(curPos: cc.Vec2) {\r\n        let returnItem = null;\r\n        this.gamePos.children.forEach((item) => {\r\n            let itemWorldPos = item.convertToWorldSpaceAR(cc.v2(0, 0));\r\n            let size = item.getContentSize();\r\n\r\n            if (curPos.x > itemWorldPos.x - size.width && curPos.x < itemWorldPos.x + size.width && curPos.y > itemWorldPos.y - size.height && curPos.y < itemWorldPos.y + size.height) {\r\n                // 在节点内\r\n                returnItem = item;\r\n            }\r\n        });\r\n        return returnItem;\r\n    }\r\n\r\n    /**\r\n     * 绘画展示区绑定事件\r\n     */\r\n    bindingDrawVisualEvent() {\r\n        this.playDrawShowNode.on(cc.Node.EventType.TOUCH_START, (even: cc.Event.EventTouch) => {\r\n            // if(DataManager.itemHideAniIsPlay || !DataManager.curGameIsRun) return;\r\n            let curWorldItem: cc.Node = this.getCurWorldPosItem(even.getLocation());\r\n            if (curWorldItem != null) {\r\n                this.curDrawLineItmeIndex = [];\r\n                this.playDrawShowNode['isDraw'] = true;\r\n                this.lastDrawCell = curWorldItem;\r\n                this.curDrawLineItmeIndex.push(curWorldItem.getComponent(ItemNode).itemIndex);\r\n            }\r\n        });\r\n        this.playDrawShowNode.on(cc.Node.EventType.TOUCH_MOVE, (even: cc.Event.EventTouch) => {\r\n            if (!this.playDrawShowNode['isDraw']) return;\r\n\r\n            let curWorldPosItem: cc.Node = this.getCurWorldPosItem(even.getLocation());\r\n\r\n            this.playDrawShowNode.getComponent(cc.Graphics).clear();\r\n            if (curWorldPosItem && this.curCellIsDraw(curWorldPosItem)) {\r\n                this.lastDrawCell['alreadyDraw'] = true;\r\n                curWorldPosItem['alreadyDraw'] = true;\r\n                this.drawLine(curWorldPosItem.convertToWorldSpaceAR(cc.v3(0, 0, 0)));\r\n                this.lastDrawCell = curWorldPosItem;\r\n                this.curDrawLineItmeIndex.push(curWorldPosItem.getComponent(ItemNode).itemIndex);\r\n            }\r\n            this.drawPlayVisualLine(even.getLocation());\r\n        });\r\n        this.playDrawShowNode.on(cc.Node.EventType.TOUCH_END, (even: cc.Event.EventTouch) => {\r\n            if (!this.playDrawShowNode['isDraw']) return;\r\n\r\n            this.playDrawShowNode['isDraw'] = false;\r\n            this.playDrawShowNode.getComponent(cc.Graphics).clear();\r\n            this.lineShowNode.getComponent(cc.Graphics).clear();\r\n\r\n            if (this.curDrawLineItmeIndex.length >= 2) {\r\n                // 达到清除条件\r\n\r\n                DataManager.itemHideAniIsPlay = true;\r\n                let aniNum = 0;\r\n                let endCall = () => {\r\n                    DataManager.itemHideAniIsPlay = false;\r\n                    this.gamePos.children.forEach((item) => {\r\n                        if (item.opacity == 255) {\r\n                            item['alreadyDraw'] = false;\r\n                        }\r\n                    });\r\n                };\r\n\r\n                for (let i: number = 0; i < this.curDrawLineItmeIndex.length; i++) {\r\n                    let index = this.curDrawLineItmeIndex[i];\r\n                    let node = this.gamePos.children[index];\r\n                    aniNum += 2;\r\n                    cc.tween(node)\r\n                        .to(0.2, { scale: 1.1 })\r\n                        .call(() => {\r\n                            if (--aniNum == 0) {\r\n                                endCall();\r\n                                node.scale = 1;\r\n                            }\r\n                        })\r\n                        .start();\r\n                    cc.tween(node)\r\n                        .to(0.2, { opacity: 0 })\r\n                        .call(() => {\r\n                            if (--aniNum == 0) {\r\n                                endCall();\r\n                            }\r\n                            let itemID = util.getRandom(0, node.getComponent(ItemNode).imgSpArr.length - 1);\r\n                            node.getComponent(ItemNode).init(itemID, node.getComponent(ItemNode).itemIndex);\r\n                            node.opacity = 255;\r\n                            DataManager._curScord += 30;\r\n                            this.updataCoin();\r\n                        })\r\n                        .start();\r\n                }\r\n            } else {\r\n                this.gamePos.children.forEach((item) => {\r\n                    if (item.opacity == 255) {\r\n                        item['alreadyDraw'] = false;\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 绘制玩家可视线条\r\n     */\r\n    drawPlayVisualLine(endPos) {\r\n        if (!this.lastDrawCell) return;\r\n\r\n        let targetPos = cc.v3(0, 0, 0);\r\n        let startPos = cc.v3(0, 0, 0);\r\n        let graphics = this.playDrawShowNode.getComponent(cc.Graphics);\r\n\r\n        startPos = this.playDrawShowNode.convertToNodeSpaceAR(this.lastDrawCell.convertToWorldSpaceAR(cc.v3(0, 0, 0)));\r\n        targetPos = this.playDrawShowNode.convertToNodeSpaceAR(cc.v3(endPos.x, endPos.y));\r\n        graphics.moveTo(startPos.x, startPos.y);\r\n        graphics.lineTo(targetPos.x, targetPos.y);\r\n        graphics.stroke();\r\n    }\r\n\r\n    /**\r\n     * 当前格子是否可绘制\r\n     */\r\n    curCellIsDraw(curItem) {\r\n        let lastItemId = this.lastDrawCell.getComponent(ItemNode).itemId;\r\n        let curItemId = curItem.getComponent(ItemNode).itemId;\r\n        if (lastItemId != curItemId || curItem['alreadyDraw']) return;\r\n\r\n        let lastIndex = this.lastDrawCell.getComponent(ItemNode).itemIndex;\r\n        let lastRow = Math.floor(lastIndex / this.colNum);\r\n        let lastCol = lastIndex % this.colNum;\r\n        let curIndex = curItem.getComponent(ItemNode).itemIndex;\r\n        let curRow = Math.floor(curIndex / this.colNum);\r\n        let curCol = curIndex % this.colNum;\r\n\r\n        if (curRow == lastRow && (lastCol + 1 == curCol || lastCol - 1 == curCol)) {\r\n            // 同行\r\n            return true;\r\n        }\r\n        if (curCol == lastCol && (lastRow + 1 == curRow || lastRow - 1 == curRow)) {\r\n            // 同列\r\n            return true;\r\n        }\r\n        if (curRow == lastRow - 1 && curCol == lastCol + 1) {\r\n            // 左上\r\n            return true;\r\n        }\r\n        if (curRow == lastRow + 1 && curCol == lastCol + 1) {\r\n            // 右上\r\n            return true;\r\n        }\r\n        if (curRow == lastRow - 1 && curCol == lastCol - 1) {\r\n            // 左下\r\n            return true;\r\n        }\r\n        if (curRow == lastRow + 1 && curCol == lastCol - 1) {\r\n            // 右下\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 绘制结果可视线条\r\n     */\r\n    drawLine(endPos) {\r\n        let targetPos = cc.v3(0, 0, 0);\r\n        let startPos = cc.v3(0, 0, 0);\r\n        let graphics = this.lineShowNode.getComponent(cc.Graphics);\r\n        startPos = this.playDrawShowNode.convertToNodeSpaceAR(this.lastDrawCell.convertToWorldSpaceAR(cc.v3(0, 0, 0)));\r\n        targetPos = this.lineShowNode.convertToNodeSpaceAR(endPos);\r\n        graphics.moveTo(startPos.x, startPos.y);\r\n        graphics.lineTo(targetPos.x, targetPos.y);\r\n        graphics.stroke();\r\n    }\r\n\r\n    /**\r\n     * 开启或关闭音效\r\n     */\r\n    openOrCloseSound() {\r\n        if (DataManager.curSoundBGIsClose) {\r\n            this.soundBtn.color = cc.color(170, 170, 170, 255);\r\n            this.node.getComponent(cc.AudioSource).volume = 0;\r\n        } else {\r\n            this.soundBtn.color = cc.color(255, 255, 255, 255);\r\n            this.node.getComponent(cc.AudioSource).volume = 1;\r\n        }\r\n        DataManager.curSoundBGIsClose = !DataManager.curSoundBGIsClose;\r\n    }\r\n\r\n    openOrCloseBG() {\r\n        if (DataManager.curSoundIsClose) {\r\n            this.musicBtn.color = cc.color(170, 170, 170, 255);\r\n            cc.find('Canvas').getComponent(cc.AudioSource).volume = 0;\r\n        } else {\r\n            this.musicBtn.color = cc.color(255, 255, 255, 255);\r\n            cc.find('Canvas').getComponent(cc.AudioSource).volume = 1;\r\n        }\r\n\r\n        DataManager.curSoundIsClose = !DataManager.curSoundIsClose;\r\n    }\r\n    /**\r\n     * 开始倒计时\r\n     */\r\n    startTimer() {\r\n        let speed = 0.01;\r\n        DataManager.timerFunc = () => {\r\n            DataManager.indexTime -= speed;\r\n            if (DataManager.indexTime <= 0) {\r\n                this.ResultFn();\r\n            }\r\n            this.updateTimerUi();\r\n            this.timerNode.getChildByName('timeText').getComponent(cc.Label).string = Math.floor(DataManager.indexTime) + 's';\r\n        };\r\n        this.schedule(DataManager.timerFunc, speed);\r\n    }\r\n\r\n    /**\r\n     * 更新倒计时\r\n     */\r\n    updateTimerUi() {\r\n        cc.find('barBg/bar', this.timerNode).getComponent(cc.Sprite).fillRange = DataManager.indexTime / DataManager.startTime;\r\n        this.timerNode.getChildByName('timeText').getComponent(cc.Label).string = Math.ceil(DataManager.indexTime) + 's';\r\n    }\r\n\r\n    updataCoin() {\r\n        this.updateUserCoin();\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[2];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n    }\r\n\r\n    /**\r\n     * 更新余额\r\n     */\r\n    updateUserCoin() {\r\n        let lableNode = this.userCoinNode.getChildByName('coinLable');\r\n        cc.tween(lableNode).to(0.1, { scale: 1.1 }).to(0.1, { scale: 1 }).start();\r\n        lableNode.getComponent(cc.Label).string = '' + DataManager.curScord;\r\n    }\r\n\r\n    /**判断结果 */\r\n    ResultFn() {\r\n        if (DataManager._curScord >= 2000) {\r\n            this.showResult(true);\r\n            DataManager.curWinNum += 200;\r\n        } else {\r\n            this.showResult(false);\r\n        }\r\n    }\r\n\r\n    /**打开提示 */\r\n    openTipNode() {\r\n        this.tipNode.getChildByName('rule').scale = 0.8;\r\n        this.tipNode.active = true;\r\n        cc.tween(this.tipNode.getChildByName('rule')).to(0.2, { scale: 1 }).start();\r\n    }\r\n\r\n    /**\r\n     * 关闭提示展示\r\n     */\r\n    hideTipNode() {\r\n        cc.tween(this.tipNode.getChildByName('rule'))\r\n            .to(0.2, { scale: 0.5 })\r\n            .call(() => {\r\n                this.tipNode.active = false;\r\n                this.tipNode.getChildByName('rule').scale = 1;\r\n            })\r\n            .start();\r\n    }\r\n\r\n    /**\r\n     * 展示结果\r\n     */\r\n    showResult(isWin) {\r\n        this.unschedule(DataManager.timerFunc);\r\n        this.unscheduleAllCallbacks();\r\n        DataManager.indexTime = DataManager.startTime;\r\n        this.gamePos.removeAllChildren();\r\n        if (isWin) {\r\n            let winNumLable = cc.find('win/winNum', this.resultNode);\r\n            DataManager.curWinNum += 100;\r\n            winNumLable.getComponent(cc.Label).string = '' + DataManager.curWinNum;\r\n        }\r\n        this.node.getComponent(cc.AudioSource).clip = this.audioResList[isWin ? 4 : 5];\r\n        this.node.getComponent(cc.AudioSource).play();\r\n        let winNode = this.resultNode.getChildByName('win');\r\n        let loseNode = this.resultNode.getChildByName('lose');\r\n        winNode.active = isWin;\r\n        loseNode.active = !isWin;\r\n        let curAniNode = isWin ? winNode : loseNode;\r\n        this.resultNode.active = true;\r\n        curAniNode.scale = 0.6;\r\n        curAniNode.opacity = 100;\r\n\r\n        cc.tween(curAniNode).to(0.3, { scale: 1.1, opacity: 255 }).to(0.3, { scale: 1 }).start();\r\n    }\r\n\r\n    /**\r\n     * 关闭结果展示\r\n     */\r\n    hideResultNode() {\r\n        DataManager.curGameIsRun = false;\r\n        this.resultNode.active = false;\r\n        cc.director.getCollisionManager().enabled = false;\r\n        DataManager._curScord = 0;\r\n        DataManager._indexTime = DataManager.startTime;\r\n        this.updateTimerUi();\r\n        this.updateUserCoin();\r\n    }\r\n}\r\n"]}